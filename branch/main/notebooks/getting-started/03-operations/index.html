

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Operations continued &mdash; Quantum Autumn School 2025  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../../../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/overrides.css?v=c88db32d" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=187304be"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=35a8b989"></script>
      <script src="../../../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../" class="icon icon-home">
            Quantum Autumn School 2025
              <img src="../../../_static/ENCCS.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../day0/">Day 0: before you arrive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pechakucha/">PechaKucha Evening</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qrisp-starter-tutorial/">Qrisp Starter Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../day1/">Day 1 - Monday, November 3rd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../day2/">Day 2 - Tuesday, November 4th</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../day3/">Day 3 - Wednesday, November 5th</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../day4/">Day 4 - Thursday, November 6th</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../day5/">Day 5 - Friday, November 7th</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../related-resources/">Related resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">Quantum Autumn School 2025</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Operations continued</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ENCCS/qas2025/blob/main/content/notebooks/getting-started/03-operations.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="operations-continued">
<h1>Operations continued<a class="headerlink" href="#operations-continued" title="Link to this heading"></a></h1>
<p>We have been using a visual editor to create quantum circuits throughout the course. Now it’s your turn to create some circuits on your own using qrisp, the next generation  quantum programming framework!</p>
<p>This notebook will help you deepen your understanding of quantum operations and universal gate sets introduced in the lecture.</p>
<p>You will:</p>
<ul class="simple">
<li><p>Review single- and two-qubit gates.</p></li>
<li><p>Learn about universal gate sets and circuit transpilation.</p></li>
<li><p>Specify the physical qubits using <strong>Qrisp</strong>.</p></li>
<li><p>Transpile multi-controlled gates into a universal two-qubit gate set.</p></li>
</ul>
<p>In order to use qrisp together with IQM devices, please make sure to install the latest version of qrisp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install &quot;iqm-client[qiskit] &gt;= 32.1.1, &lt; 33.0&quot;
<span class="o">%</span><span class="k">pip</span> install &quot;qrisp[iqm]&quot;
</pre></div>
</div>
</div>
</div>
<section id="universal-gate-sets">
<h2>Universal Gate Sets<a class="headerlink" href="#universal-gate-sets" title="Link to this heading"></a></h2>
<p>A <strong>universal gate set</strong> allows any quantum computation to be approximated to arbitrary accuracy.</p>
<p>Common examples:</p>
<ul class="simple">
<li><p>{H, T, CNOT}</p></li>
<li><p>{Rz, Rx, CZ}</p></li>
<li><p>{CZ, R}  (used in this notebook)</p></li>
</ul>
<p>The process of <strong>transpilation</strong> converts a general quantum circuit into one that uses only gates from the chosen universal set.</p>
<p><strong>Task: Use the <code class="docutils literal notranslate"><span class="pre">qc.transpile(basis_gates=[&quot;cz&quot;,</span> <span class="pre">&quot;r&quot;])</span></code> method to transpile the circuit and compare it to the untranspiled version.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the Qrisp quantum library</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qrisp</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Define two qubits as a quantum variable</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumVariable</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Apply a Hadamard to the first qubit</span>
<span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Apply a CNOT (control: q[0], target: q[1])</span>
<span class="n">cx</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Visualize and compile</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">qs</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TODO: print the transpiled circuit diagram here&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="multi-controlled-gates-and-decomposition">
<h2>Multi-Controlled Gates and Decomposition<a class="headerlink" href="#multi-controlled-gates-and-decomposition" title="Link to this heading"></a></h2>
<p>The <strong>multi-controlled X gate (MCX)</strong> generalizes the CNOT gate.<br />
For example, <code class="docutils literal notranslate"><span class="pre">mcx([0,1,2],</span> <span class="pre">3)</span></code> flips qubit 3 if all control qubits (0,1,2) are in state <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<p>However, <strong>quantum hardware</strong> typically only supports <em>two-qubit gates</em>, so multi-controlled gates must be <strong>decomposed</strong> into equivalent two-qubit operations.</p>
<p><strong>Task: Create a circuit that uses the MCX gate and transpile it to see how it is decomposed into two-qubit gates.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define 4 qubits</span>
<span class="n">qv</span> <span class="o">=</span> <span class="n">QuantumVariable</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Apply a multi-controlled X (at least three controls -&gt; one target)</span>

<span class="c1"># Compile and transpile</span>

<span class="c1"># Transpile to two-qubit universal gate set</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Task: MCX Decomposition</strong></p>
<ol class="arabic simple">
<li><p>Observe the above transpiled version of the <code class="docutils literal notranslate"><span class="pre">mcx</span></code> gate (tip: use <code class="docutils literal notranslate"><span class="pre">__dir__()</span></code> on the object return by the <code class="docutils literal notranslate"><span class="pre">transpile</span></code> method).</p></li>
<li><p>How many <strong>two-qubit</strong> gates does it require?</p></li>
<li><p>Compare the number of required cz gates to the number of required iswap gates when considering the universal gate set that includes iSWAP as the two-qubit gate {iSWAP, R}.</p></li>
<li><p>For the quick ones: Try building your own 3-control gate manually using <code class="docutils literal notranslate"><span class="pre">cx</span></code> and <code class="docutils literal notranslate"><span class="pre">cz</span></code> gates only.</p></li>
</ol>
<p>When running on hardware, this transpilation is automatically handled for us, however, it makes sense to understand what is happening “under the hood”.</p>
</section>
<section id="improving-outcomes-by-selecting-physical-qubits">
<h2>Improving outcomes by selecting physical qubits<a class="headerlink" href="#improving-outcomes-by-selecting-physical-qubits" title="Link to this heading"></a></h2>
<p>A typical quantum processor consists of multiple qubits with varying coherence times and gate fidelities. By selecting the best physical qubits for your circuit, you can improve the overall performance and reliability of your quantum computations.</p>
<p>This can be done in any framework. For qrisp, the following is a way to do it:</p>
<p><strong>Task: But, oops, the coupling map is incomplete, check IQM Resonance’s coupling map and add at least one edge to give the transpiler enough freedom to map the circuit.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qrisp.interface</span><span class="w"> </span><span class="kn">import</span> <span class="n">IQMBackend</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">qiskit</span>
<span class="c1"># Define a custom transpilation procedure (default will be default </span>
<span class="c1"># qiskit transpiler to match connectivity and gate set).</span>
<span class="c1"># Should take a Qiskit circuit and return a Qiskit circuit</span>


<span class="n">qb_index</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;QB&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;QB&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>


<span class="k">def</span><span class="w"> </span><span class="nf">custom_transpilation</span><span class="p">(</span><span class="n">qc</span> <span class="p">:</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">QuantumCircuit</span><span class="p">):</span>
    <span class="c1"># TODO: Check and change only the next line</span>
    <span class="n">couplings</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;QB15&quot;</span><span class="p">,</span><span class="s2">&quot;QB16&quot;</span><span class="p">],[</span><span class="s2">&quot;QB16&quot;</span><span class="p">,</span><span class="s2">&quot;QB24&quot;</span><span class="p">],[</span><span class="s2">&quot;QB23&quot;</span><span class="p">,</span><span class="s2">&quot;QB24&quot;</span><span class="p">],[</span><span class="s2">&quot;QB23&quot;</span><span class="p">,</span><span class="s2">&quot;QB15&quot;</span><span class="p">]]</span> 
    <span class="n">reduced_coupling_map</span> <span class="o">=</span> <span class="p">[[</span><span class="n">qb_index</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">couplings</span><span class="p">]</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">qiskit</span><span class="o">.</span><span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">basis_gates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cz&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">,</span> <span class="s2">&quot;reset&quot;</span><span class="p">],</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">reduced_coupling_map</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">qc</span>
    
<span class="c1"># Create a backend object</span>
<span class="n">quantum_computer</span> <span class="o">=</span> <span class="n">IQMBackend</span><span class="p">(</span><span class="n">api_token</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter your IQM Resonance API token: &quot;</span><span class="p">),</span> 
                          <span class="n">device_instance</span> <span class="o">=</span> <span class="s2">&quot;emerald&quot;</span><span class="p">,</span>
                          <span class="n">transpiler</span> <span class="o">=</span> <span class="n">custom_transpilation</span><span class="p">)</span>


<span class="n">qv</span> <span class="o">=</span> <span class="n">QuantumVariable</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">x</span><span class="p">(</span><span class="n">qv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cx</span><span class="p">(</span><span class="n">qv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">cx</span><span class="p">(</span><span class="n">qv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cx</span><span class="p">(</span><span class="n">qv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">qv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">cx</span><span class="p">(</span><span class="n">qv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">qv</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>


<span class="n">meas_res</span> <span class="o">=</span> <span class="n">qv</span><span class="o">.</span><span class="n">get_measurement</span><span class="p">(</span><span class="n">backend</span> <span class="o">=</span> <span class="n">quantum_computer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Task: Then, try to find qubits with low readout errors and good two-qubit gate fidelities for your circuit.</strong></p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, The contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>